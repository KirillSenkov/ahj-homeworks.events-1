(()=>{"use strict";const t=new class{getFormattedTimestamp(){const t=new Date;return`[${String(t.getDate()).padStart(2,"0")}.${String(t.getMonth()+1).padStart(2,"0")}.${String(t.getFullYear()).slice(-2)} ${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}:${String(t.getSeconds()).padStart(2,"0")}.${String(t.getMilliseconds()).padStart(3,"0")}]`}log(t,e){const n=`${this.getFormattedTimestamp()} [${e}] ${t}`;return console.log(n),n}},e="ScoreBoard";class n{#t;#e=document.createElement("div");#n=document.createElement("div");#i=document.createElement("div");constructor(t){this.#t=t,this.#e.classList.add("score-board"),this.#e.insertAdjacentText("afterbegin","Player"),this.#e.insertAdjacentElement("beforeend",this.#n),this.#e.insertAdjacentText("beforeend","Goblin"),this.#e.insertAdjacentElement("beforeend",this.#i),this.#n.textContent=0,this.#i.textContent=0}get(){return this.#e}hit(){this.#n.textContent++,5==this.#n.textContent&&this.#t.stop()}miss(){this.#i.textContent++,5==this.#i.textContent&&this.#t.stop()}reset(){this.#n.textContent=this.#i.textContent="0"}getLeader(){const n=Math.max(Number(this.#n.textContent),Number(this.#i.textContent));return Number(this.#n.textContent)===n&&Number(this.#i.textContent)===n?(t.log("getLeader() return even",e),"even"):Number(this.#n.textContent)===n?(t.log("getLeader() return player",e),"player"):Number(this.#i.textContent)===n?(t.log("getLeader() return goblin",e),"goblin"):(t.log("getLeader() return what?",e),"what?")}}class i{#o;#s;#r;#a=!0;#l;#h=0;#d=!1;constructor(){this.#o=this.#c(),this.#s=this.#o.children}get(){return this.#o}start(t){this.#l.reset(),this.#a=!0,this.#d=!1,o.warpLoop(this,t)}stop(){this.#a=!1,this.#r=!1,this.#h=0}#g(){let t;switch(this.#l.getLeader()){case"even":t="Ничья.\n\n";break;case"player":t="Вы победили!\n\n";break;case"goblin":t="Вы проиграли, сударь.\nВы неудачник.\n\n";break;default:t="? я чото п\n\n"}return new Promise((e=>{requestAnimationFrame((()=>{requestAnimationFrame((()=>{const n=confirm(t+"Начать заново?");e(n)}))}))}))}#m(){const t=document.createElement("p");this.#o.remove(),t.textContent="Have a nice day, sir.",t.classList.add("goodby"),document.body.append(t)}holeWarp(e,n){this.#h++,t.log(`WARP №${this.#h}: this.#holeNum = ${this.#r}.`,"BattleField"),this.#s[this.#r]&&this.#s[this.#r].classList.remove("goblin"),this.#d&&this.#l.miss(),this.#a?(this.#r=this.#b(this.#r),this.#s[this.#r].classList.add("goblin")):(clearInterval(e),this.#g().then((t=>{t?this.start(n):this.#m()}))),this.#d=!0}#u=function(t){t.target.matches(".goblin")&&this.#d&&(this.#d=!1,this.#l.hit(),t.target.classList.add("mjolnir-bash"),setTimeout((()=>{t.target.classList.remove("goblin")}),400),setTimeout((()=>{t.target.classList.remove("mjolnir-bash")}),700))};#c(){const t=document.createElement("div");t.classList.add("container"),t.addEventListener("click",this.#u.bind(this),!0);for(let e=0;e<16;e++){const e=document.createElement("div");e.classList.add("hole"),t.append(e)}return this.#l=new n(this),t.append(this.#l.get()),t}#b(t,e=0,n=15){let i=Math.floor(Math.random()*(n-e+1))+e;for(;i===t;)i=Math.floor(Math.random()*(n-e+1))+e;return i}}class o{static startWhacking(t){const{body:e}=document,n=new i;e.append(n.get()),o.warpLoop(n,t)}static warpLoop(e,n){t.log(`NEW WhackTheGoblin.warpLoop(${e}, ${n}) started.`,"WhackTheGoblin");const i=setInterval((()=>{e.holeWarp(i,n)}),1e3*n)}}document.addEventListener("DOMContentLoaded",(()=>{t.log("BEFORE WhackTheGoblin.startWhacking(2);","app"),o.startWhacking(2),t.log("AFTER WhackTheGoblin.startWhacking(2);","app")}))})();